{"version":3,"file":"QrCode.vue.js","sources":["../../../src/components/basic/QrCode.vue"],"sourcesContent":["<template>\n  <div class=\"qrcode-wrapper\">\n    <canvas ref=\"canvasRef\" />\n    <div v-if=\"loading\" class=\"qrcode-loading\">\n      <a-spin />\n    </div>\n    <div v-if=\"showDownload\" class=\"qrcode-actions\">\n      <a-button size=\"small\" @click=\"handleDownload\">\n        <template #icon><DownloadOutlined /></template>\n        下载二维码\n      </a-button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, watch, onMounted, nextTick } from 'vue'\nimport { message } from 'ant-design-vue'\nimport { DownloadOutlined } from '@ant-design/icons-vue'\n\nconst props = defineProps({\n  value: {\n    type: String,\n    required: true\n  },\n  size: {\n    type: Number,\n    default: 200\n  },\n  level: {\n    type: String,\n    default: 'M',\n    validator: (value) => ['L', 'M', 'Q', 'H'].includes(value)\n  },\n  bgColor: {\n    type: String,\n    default: '#ffffff'\n  },\n  fgColor: {\n    type: String,\n    default: '#000000'\n  },\n  showDownload: {\n    type: Boolean,\n    default: true\n  },\n  downloadFileName: {\n    type: String,\n    default: 'qrcode'\n  }\n})\n\nconst canvasRef = ref(null)\nconst loading = ref(false)\n\nonMounted(() => {\n  renderQRCode()\n})\n\nwatch([() => props.value, () => props.size, () => props.level], () => {\n  renderQRCode()\n})\n\nconst renderQRCode = async () => {\n  if (!props.value || !canvasRef.value) return\n\n  loading.value = true\n\n  try {\n    // 简化版本：使用 Canvas 绘制简单的二维码占位符\n    // 实际项目中应该使用 qrcode.js 或 qrcodejs2 库\n    const canvas = canvasRef.value\n    const ctx = canvas.getContext('2d')\n\n    canvas.width = props.size\n    canvas.height = props.size\n\n    // 绘制背景\n    ctx.fillStyle = props.bgColor\n    ctx.fillRect(0, 0, props.size, props.size)\n\n    // 绘制前景（简化的二维码图案）\n    ctx.fillStyle = props.fgColor\n    const cellSize = props.size / 25\n\n    for (let i = 0; i < 25; i++) {\n      for (let j = 0; j < 25; j++) {\n        // 简单的棋盘图案作为示例\n        if ((i + j) % 2 === 0 || Math.random() > 0.5) {\n          ctx.fillRect(i * cellSize, j * cellSize, cellSize, cellSize)\n        }\n      }\n    }\n\n    // 绘制中心定位点\n    drawPositionBox(ctx, 2, 2, cellSize)\n    drawPositionBox(ctx, 18, 2, cellSize)\n    drawPositionBox(ctx, 2, 18, cellSize)\n\n  } catch (error) {\n    console.error('Failed to render QR code:', error)\n    message.error('二维码生成失败')\n  } finally {\n    loading.value = false\n  }\n}\n\nconst drawPositionBox = (ctx, x, y, cellSize) => {\n  // 外框\n  ctx.fillRect(x * cellSize, y * cellSize, 7 * cellSize, cellSize)\n  ctx.fillRect(x * cellSize, y * cellSize, cellSize, 7 * cellSize)\n  ctx.fillRect((x + 6) * cellSize, y * cellSize, cellSize, 7 * cellSize)\n  ctx.fillRect(x * cellSize, (y + 6) * cellSize, 7 * cellSize, cellSize)\n\n  // 中心点\n  ctx.fillRect((x + 2) * cellSize, (y + 2) * cellSize, 3 * cellSize, 3 * cellSize)\n}\n\nconst handleDownload = () => {\n  try {\n    const canvas = canvasRef.value\n    const url = canvas.toDataURL('image/png')\n    const link = document.createElement('a')\n    link.download = `${props.downloadFileName}.png`\n    link.href = url\n    link.click()\n    message.success('下载成功')\n  } catch (error) {\n    console.error('Failed to download QR code:', error)\n    message.error('下载失败')\n  }\n}\n\ndefineExpose({\n  download: handleDownload\n})\n</script>\n\n<style scoped lang=\"scss\">\n.qrcode-wrapper {\n  display: inline-block;\n  position: relative;\n\n  canvas {\n    display: block;\n  }\n}\n\n.qrcode-loading {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.8);\n}\n\n.qrcode-actions {\n  margin-top: 12px;\n  text-align: center;\n}\n</style>\n"],"names":[],"mappings":"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"}