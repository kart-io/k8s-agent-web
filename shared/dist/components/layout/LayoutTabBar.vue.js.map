{"version":3,"file":"LayoutTabBar.vue.js","sources":["../../../src/components/layout/LayoutTabBar.vue"],"sourcesContent":["<template>\n  <div class=\"layout-tab-bar\">\n    <div class=\"tab-bar-content\">\n      <!-- 标签页列表 -->\n      <div ref=\"tabsContainer\" class=\"tabs-container\">\n        <div\n          v-for=\"tab in tabs\"\n          :key=\"tab.key\"\n          :class=\"['tab-item', { 'tab-active': tab.key === activeKey }]\"\n          @click=\"handleTabClick(tab)\"\n          @contextmenu.prevent=\"handleContextMenu($event, tab)\"\n        >\n          <component\n            :is=\"getIcon(tab.icon)\"\n            v-if=\"tab.icon\"\n            class=\"tab-icon\"\n          />\n          <span class=\"tab-label\">{{ tab.label }}</span>\n          <CloseOutlined\n            v-if=\"!tab.affix && tabs.length > 1\"\n            class=\"tab-close\"\n            @click.stop=\"handleClose(tab)\"\n          />\n        </div>\n      </div>\n\n      <!-- 刷新按钮 -->\n      <a-tooltip title=\"刷新当前页\">\n        <a-button\n          type=\"text\"\n          size=\"small\"\n          class=\"tab-action-btn\"\n          @click=\"handleRefresh\"\n        >\n          <ReloadOutlined :class=\"{ 'rotating': isRefreshing }\" />\n        </a-button>\n      </a-tooltip>\n\n      <!-- 更多操作 -->\n      <a-dropdown placement=\"bottomRight\">\n        <a-button type=\"text\" size=\"small\" class=\"tab-action-btn\">\n          <DownOutlined />\n        </a-button>\n        <template #overlay>\n          <a-menu @click=\"handleMenuClick\">\n            <a-menu-item key=\"refresh\">\n              <ReloadOutlined />\n              刷新当前\n            </a-menu-item>\n            <a-menu-divider />\n            <a-menu-item key=\"close-current\" :disabled=\"tabs.length === 1\">\n              <CloseOutlined />\n              关闭当前\n            </a-menu-item>\n            <a-menu-item key=\"close-left\" :disabled=\"!canCloseLeft\">\n              <VerticalRightOutlined />\n              关闭左侧\n            </a-menu-item>\n            <a-menu-item key=\"close-right\" :disabled=\"!canCloseRight\">\n              <VerticalLeftOutlined />\n              关闭右侧\n            </a-menu-item>\n            <a-menu-item key=\"close-other\" :disabled=\"tabs.length === 1\">\n              <ColumnWidthOutlined />\n              关闭其他\n            </a-menu-item>\n            <a-menu-divider />\n            <a-menu-item key=\"close-all\" :disabled=\"onlyAffixTabs\">\n              <MinusOutlined />\n              关闭全部\n            </a-menu-item>\n          </a-menu>\n        </template>\n      </a-dropdown>\n    </div>\n\n    <!-- 右键菜单 -->\n    <a-dropdown\n      v-model:open=\"contextMenuVisible\"\n      :trigger=\"[]\"\n      placement=\"bottomLeft\"\n      :overlay-style=\"{ position: 'fixed', left: contextMenuPosition.x + 'px', top: contextMenuPosition.y + 'px' }\"\n    >\n      <div style=\"position: absolute; width: 0; height: 0;\"></div>\n      <template #overlay>\n        <a-menu @click=\"handleContextMenuClick\">\n          <a-menu-item key=\"refresh\">\n            <ReloadOutlined />\n            刷新\n          </a-menu-item>\n          <a-menu-divider />\n          <a-menu-item key=\"close\" :disabled=\"contextTab?.affix || tabs.length === 1\">\n            <CloseOutlined />\n            关闭\n          </a-menu-item>\n          <a-menu-item key=\"close-left\" :disabled=\"!canCloseLeft\">\n            <VerticalRightOutlined />\n            关闭左侧\n          </a-menu-item>\n          <a-menu-item key=\"close-right\" :disabled=\"!canCloseRight\">\n            <VerticalLeftOutlined />\n            关闭右侧\n          </a-menu-item>\n          <a-menu-item key=\"close-other\" :disabled=\"tabs.length === 1\">\n            <ColumnWidthOutlined />\n            关闭其他\n          </a-menu-item>\n        </a-menu>\n      </template>\n    </a-dropdown>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed } from 'vue'\nimport {\n  CloseOutlined,\n  ReloadOutlined,\n  DownOutlined,\n  VerticalRightOutlined,\n  VerticalLeftOutlined,\n  ColumnWidthOutlined,\n  MinusOutlined\n} from '@ant-design/icons-vue'\nimport { getIconComponent } from '../../utils'\n\nconst props = defineProps({\n  tabs: {\n    type: Array,\n    required: true,\n    default: () => []\n  },\n  activeKey: {\n    type: String,\n    required: true\n  }\n})\n\nconst emit = defineEmits([\n  'tab-click',\n  'tab-close',\n  'tab-refresh',\n  'close-left',\n  'close-right',\n  'close-other',\n  'close-all'\n])\n\nconst tabsContainer = ref(null)\nconst contextMenuVisible = ref(false)\nconst contextMenuPosition = ref({ x: 0, y: 0 })\nconst contextTab = ref(null)\nconst isRefreshing = ref(false)\n\nconst currentTabIndex = computed(() => {\n  return props.tabs.findIndex(t => t.key === props.activeKey)\n})\n\nconst canCloseLeft = computed(() => {\n  const index = contextTab.value\n    ? props.tabs.findIndex(t => t.key === contextTab.value.key)\n    : currentTabIndex.value\n  return index > 0 && props.tabs.slice(0, index).some(t => !t.affix)\n})\n\nconst canCloseRight = computed(() => {\n  const index = contextTab.value\n    ? props.tabs.findIndex(t => t.key === contextTab.value.key)\n    : currentTabIndex.value\n  return index < props.tabs.length - 1 && props.tabs.slice(index + 1).some(t => !t.affix)\n})\n\nconst onlyAffixTabs = computed(() => {\n  return props.tabs.every(t => t.affix)\n})\n\nconst getIcon = (iconName) => {\n  if (!iconName) return null\n  return getIconComponent(iconName)\n}\n\nconst handleTabClick = (tab) => {\n  emit('tab-click', tab)\n}\n\nconst handleClose = (tab) => {\n  emit('tab-close', tab)\n}\n\nconst handleRefresh = () => {\n  isRefreshing.value = true\n  emit('tab-refresh')\n  setTimeout(() => {\n    isRefreshing.value = false\n  }, 1000)\n}\n\nconst handleMenuClick = ({ key }) => {\n  switch (key) {\n    case 'refresh':\n      handleRefresh()\n      break\n    case 'close-current':\n      const currentTab = props.tabs.find(t => t.key === props.activeKey)\n      if (currentTab && !currentTab.affix) {\n        emit('tab-close', currentTab)\n      }\n      break\n    case 'close-left':\n      emit('close-left')\n      break\n    case 'close-right':\n      emit('close-right')\n      break\n    case 'close-other':\n      emit('close-other')\n      break\n    case 'close-all':\n      emit('close-all')\n      break\n  }\n}\n\nconst handleContextMenu = (e, tab) => {\n  e.preventDefault()\n  contextTab.value = tab\n  contextMenuPosition.value = { x: e.clientX, y: e.clientY }\n  contextMenuVisible.value = true\n}\n\nconst handleContextMenuClick = ({ key }) => {\n  contextMenuVisible.value = false\n  switch (key) {\n    case 'refresh':\n      emit('tab-click', contextTab.value)\n      setTimeout(() => handleRefresh(), 100)\n      break\n    case 'close':\n      if (!contextTab.value.affix) {\n        emit('tab-close', contextTab.value)\n      }\n      break\n    case 'close-left':\n      emit('tab-click', contextTab.value)\n      setTimeout(() => emit('close-left'), 100)\n      break\n    case 'close-right':\n      emit('tab-click', contextTab.value)\n      setTimeout(() => emit('close-right'), 100)\n      break\n    case 'close-other':\n      emit('tab-click', contextTab.value)\n      setTimeout(() => emit('close-other'), 100)\n      break\n  }\n  contextTab.value = null\n}\n</script>\n\n<style scoped lang=\"scss\">\n.layout-tab-bar {\n  background: #fff;\n  border-bottom: 1px solid #f0f0f0;\n  position: relative;\n  z-index: 9;\n}\n\n.tab-bar-content {\n  display: flex;\n  align-items: center;\n  height: 36px;\n  padding: 0 8px;\n  gap: 4px;\n}\n\n.tabs-container {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  overflow-x: auto;\n  overflow-y: hidden;\n  gap: 4px;\n\n  &::-webkit-scrollbar {\n    height: 0;\n  }\n\n  scrollbar-width: none;\n}\n\n.tab-item {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  height: 28px;\n  padding: 0 12px;\n  border-radius: 2px;\n  background: #fafafa;\n  border: 1px solid #e8e8e8;\n  cursor: pointer;\n  user-select: none;\n  white-space: nowrap;\n  flex-shrink: 0;\n  transition: all 0.3s;\n\n  &:hover {\n    background: #e6f7ff;\n    border-color: #91d5ff;\n    color: #1890ff;\n\n    .tab-close {\n      opacity: 1;\n    }\n  }\n\n  &.tab-active {\n    background: #1890ff;\n    border-color: #1890ff;\n    color: #fff;\n\n    .tab-close {\n      opacity: 1;\n      color: #fff;\n\n      &:hover {\n        color: #fff;\n        background: rgba(255, 255, 255, 0.2);\n      }\n    }\n  }\n}\n\n.tab-icon {\n  font-size: 14px;\n}\n\n.tab-label {\n  font-size: 13px;\n  max-width: 120px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.tab-close {\n  font-size: 10px;\n  padding: 2px;\n  border-radius: 2px;\n  opacity: 0;\n  transition: all 0.3s;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.1);\n    color: #ff4d4f;\n  }\n}\n\n.tab-action-btn {\n  height: 28px;\n  width: 28px;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  border-radius: 2px;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #f0f0f0;\n  }\n}\n\n.rotating {\n  animation: rotate 1s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n"],"names":[],"mappings":"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"}