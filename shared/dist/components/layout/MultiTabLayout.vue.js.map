{"version":3,"file":"MultiTabLayout.vue.js","sources":["../../../src/components/layout/MultiTabLayout.vue"],"sourcesContent":["<template>\n  <div class=\"multi-tab-layout\">\n    <!-- 面包屑导航 -->\n    <div v-if=\"breadcrumb\" class=\"breadcrumb-bar\">\n      <a-breadcrumb>\n        <a-breadcrumb-item v-for=\"item in breadcrumbItems\" :key=\"item.path\">\n          {{ item.label }}\n        </a-breadcrumb-item>\n      </a-breadcrumb>\n    </div>\n\n    <!-- 多标签页 -->\n    <div class=\"tab-bar\">\n      <a-tabs\n        v-model:activeKey=\"activeTabKey\"\n        type=\"editable-card\"\n        hide-add\n        @edit=\"onEdit\"\n        @change=\"onTabChange\"\n      >\n        <a-tab-pane\n          v-for=\"tab in openTabs\"\n          :key=\"tab.key\"\n          :closable=\"tab.closable !== false && openTabs.length > 1\"\n        >\n          <template #tab>\n            <span>{{ tab.label }}</span>\n          </template>\n        </a-tab-pane>\n      </a-tabs>\n\n      <!-- 标签操作按钮 -->\n      <div class=\"tab-actions\">\n        <a-dropdown>\n          <template #overlay>\n            <a-menu @click=\"handleMenuClick\">\n              <a-menu-item key=\"refresh\">\n                <ReloadOutlined />\n                刷新当前\n              </a-menu-item>\n              <a-menu-divider />\n              <a-menu-item key=\"close\">\n                <CloseOutlined />\n                关闭当前\n              </a-menu-item>\n              <a-menu-item key=\"close-other\">\n                <ColumnWidthOutlined />\n                关闭其他\n              </a-menu-item>\n              <a-menu-item key=\"close-all\">\n                <MinusOutlined />\n                关闭全部\n              </a-menu-item>\n            </a-menu>\n          </template>\n          <a-button type=\"text\" size=\"small\">\n            <DownOutlined />\n          </a-button>\n        </a-dropdown>\n      </div>\n    </div>\n\n    <!-- 内容区域 -->\n    <div class=\"tab-content\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport {\n  ReloadOutlined,\n  CloseOutlined,\n  ColumnWidthOutlined,\n  MinusOutlined,\n  DownOutlined\n} from '@ant-design/icons-vue'\n\nconst props = defineProps({\n  breadcrumb: {\n    type: Boolean,\n    default: true\n  }\n})\n\nconst emit = defineEmits(['tab-change', 'tab-close', 'tab-refresh'])\n\nconst router = useRouter()\nconst route = useRoute()\n\n// 已打开的标签页列表\nconst openTabs = ref([])\nconst activeTabKey = ref('')\n\n// 面包屑数据\nconst breadcrumbItems = computed(() => {\n  const currentTab = openTabs.value.find(t => t.key === activeTabKey.value)\n  if (!currentTab?.breadcrumb) return []\n  return currentTab.breadcrumb\n})\n\n// 添加标签页\nconst addTab = (tab) => {\n  const existingTab = openTabs.value.find(t => t.key === tab.key)\n  if (!existingTab) {\n    openTabs.value.push(tab)\n  }\n  activeTabKey.value = tab.key\n}\n\n// 移除标签页\nconst removeTab = (targetKey) => {\n  const targetIndex = openTabs.value.findIndex(t => t.key === targetKey)\n  if (targetIndex === -1) return\n\n  const newTabs = openTabs.value.filter(t => t.key !== targetKey)\n\n  // 如果关闭的是当前标签，需要激活另一个标签\n  if (activeTabKey.value === targetKey && newTabs.length > 0) {\n    // 激活前一个或后一个标签\n    const newActiveTab = newTabs[Math.max(0, targetIndex - 1)]\n    activeTabKey.value = newActiveTab.key\n    if (newActiveTab.path) {\n      router.push(newActiveTab.path)\n    }\n  }\n\n  openTabs.value = newTabs\n  emit('tab-close', targetKey)\n}\n\n// 监听路由变化，自动添加标签\nwatch(\n  () => route.path,\n  (newPath) => {\n    if (route.meta?.noTab) return // 某些页面不显示标签\n\n    const tab = {\n      key: newPath,\n      label: route.meta?.title || '未命名',\n      path: newPath,\n      closable: route.meta?.affix !== true, // affix 为 true 的标签不可关闭\n      breadcrumb: route.meta?.breadcrumb || []\n    }\n\n    addTab(tab)\n  },\n  { immediate: true }\n)\n\nconst onTabChange = (key) => {\n  const tab = openTabs.value.find(t => t.key === key)\n  if (tab?.path && tab.path !== route.path) {\n    router.push(tab.path)\n  }\n  emit('tab-change', key, tab)\n}\n\nconst onEdit = (targetKey, action) => {\n  if (action === 'remove') {\n    removeTab(targetKey)\n  }\n}\n\nconst handleMenuClick = ({ key }) => {\n  switch (key) {\n    case 'refresh':\n      emit('tab-refresh', activeTabKey.value)\n      window.location.reload()\n      break\n    case 'close':\n      if (openTabs.value.length > 1) {\n        removeTab(activeTabKey.value)\n      }\n      break\n    case 'close-other':\n      const currentTab = openTabs.value.find(t => t.key === activeTabKey.value)\n      openTabs.value = openTabs.value.filter(\n        t => t.key === activeTabKey.value || t.closable === false\n      )\n      break\n    case 'close-all':\n      const affixTabs = openTabs.value.filter(t => t.closable === false)\n      if (affixTabs.length > 0) {\n        openTabs.value = affixTabs\n        activeTabKey.value = affixTabs[0].key\n        if (affixTabs[0].path) {\n          router.push(affixTabs[0].path)\n        }\n      }\n      break\n  }\n}\n\n// 暴露方法供外部使用\ndefineExpose({\n  addTab,\n  removeTab,\n  openTabs,\n  activeTabKey\n})\n</script>\n\n<style scoped>\n.multi-tab-layout {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  background: #f0f2f5;\n}\n\n.breadcrumb-bar {\n  padding: 12px 16px;\n  background: #fff;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.tab-bar {\n  display: flex;\n  align-items: center;\n  background: #fff;\n  border-bottom: 1px solid #f0f0f0;\n  position: relative;\n}\n\n.tab-bar :deep(.ant-tabs) {\n  flex: 1;\n  margin-bottom: 0;\n}\n\n.tab-bar :deep(.ant-tabs-nav) {\n  margin-bottom: 0;\n  padding: 0 8px;\n}\n\n.tab-bar :deep(.ant-tabs-nav::before) {\n  border-bottom: none;\n}\n\n.tab-bar :deep(.ant-tabs-tab) {\n  border: 1px solid transparent;\n  background: transparent;\n  margin: 4px 2px !important;\n  padding: 6px 12px;\n  border-radius: 2px;\n  transition: all 0.3s;\n}\n\n.tab-bar :deep(.ant-tabs-tab:hover) {\n  background: #f5f5f5;\n}\n\n.tab-bar :deep(.ant-tabs-tab-active) {\n  background: #1890ff;\n  border-color: #1890ff;\n}\n\n.tab-bar :deep(.ant-tabs-tab-active .ant-tabs-tab-btn) {\n  color: #fff;\n}\n\n.tab-bar :deep(.ant-tabs-tab-active .ant-tabs-tab-remove) {\n  color: #fff;\n}\n\n.tab-bar :deep(.ant-tabs-tab-active .ant-tabs-tab-remove:hover) {\n  color: #fff;\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.tab-bar :deep(.ant-tabs-content-holder) {\n  display: none;\n}\n\n.tab-actions {\n  padding: 0 12px;\n  border-left: 1px solid #f0f0f0;\n}\n\n.tab-content {\n  flex: 1;\n  overflow: auto;\n  padding: 16px;\n}\n</style>\n"],"names":["_openBlock","_createElementBlock","_createVNode","_Fragment","_renderList","_createBlock","_createTextVNode","_toDisplayString","_createElementVNode","_unref","_renderSlot"],"mappings":"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"}