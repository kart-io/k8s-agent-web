{"version":3,"file":"BasicTable.vue.js","sources":["../../../src/components/table/BasicTable.vue"],"sourcesContent":["<template>\n  <div class=\"basic-table\">\n    <div v-if=\"showToolbar\" class=\"table-toolbar\">\n      <div class=\"toolbar-left\">\n        <slot name=\"toolbar-left\">\n          <span v-if=\"title\" class=\"table-title\">{{ title }}</span>\n        </slot>\n      </div>\n      <div class=\"toolbar-right\">\n        <slot name=\"toolbar-right\">\n          <a-space>\n            <a-button v-if=\"showRefresh\" @click=\"handleRefresh\">\n              <template #icon><ReloadOutlined /></template>\n              刷新\n            </a-button>\n            <a-button v-if=\"showColumnSetting\">\n              <template #icon><SettingOutlined /></template>\n              列设置\n            </a-button>\n          </a-space>\n        </slot>\n      </div>\n    </div>\n\n    <a-table\n      v-bind=\"$attrs\"\n      :columns=\"innerColumns\"\n      :data-source=\"dataSource\"\n      :loading=\"loading\"\n      :pagination=\"innerPagination\"\n      :row-key=\"rowKey\"\n      :scroll=\"scroll\"\n      @change=\"handleTableChange\"\n    >\n      <!-- 透传所有插槽 -->\n      <template v-for=\"(_, name) in $slots\" #[name]=\"slotData\">\n        <slot :name=\"name\" v-bind=\"slotData || {}\" />\n      </template>\n\n      <!-- 操作列插槽 -->\n      <template v-if=\"actionColumn\" #action=\"{ record }\">\n        <slot name=\"action\" :record=\"record\">\n          <a-space>\n            <a-button v-if=\"actionColumn.edit\" type=\"link\" size=\"small\" @click=\"handleEdit(record)\">\n              编辑\n            </a-button>\n            <a-popconfirm\n              v-if=\"actionColumn.delete\"\n              title=\"确定要删除吗？\"\n              @confirm=\"handleDelete(record)\"\n            >\n              <a-button type=\"link\" danger size=\"small\">删除</a-button>\n            </a-popconfirm>\n          </a-space>\n        </slot>\n      </template>\n    </a-table>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { ReloadOutlined, SettingOutlined } from '@ant-design/icons-vue'\n\nconst props = defineProps({\n  // 数据源\n  dataSource: {\n    type: Array,\n    default: () => []\n  },\n  // 列配置\n  columns: {\n    type: Array,\n    default: () => []\n  },\n  // 是否显示工具栏\n  showToolbar: {\n    type: Boolean,\n    default: true\n  },\n  // 表格标题\n  title: {\n    type: String,\n    default: ''\n  },\n  // 是否显示刷新按钮\n  showRefresh: {\n    type: Boolean,\n    default: true\n  },\n  // 是否显示列设置按钮\n  showColumnSetting: {\n    type: Boolean,\n    default: false\n  },\n  // 是否加载中\n  loading: {\n    type: Boolean,\n    default: false\n  },\n  // 分页配置\n  pagination: {\n    type: [Object, Boolean],\n    default: () => ({})\n  },\n  // 行的 key\n  rowKey: {\n    type: [String, Function],\n    default: 'id'\n  },\n  // 滚动配置\n  scroll: {\n    type: Object,\n    default: () => ({ x: 'max-content' })\n  },\n  // 操作列配置\n  actionColumn: {\n    type: Object,\n    default: null\n  },\n  // 请求数据的方法\n  api: {\n    type: Function,\n    default: null\n  },\n  // 立即加载\n  immediate: {\n    type: Boolean,\n    default: true\n  },\n  // 请求参数\n  searchParams: {\n    type: Object,\n    default: () => ({})\n  }\n})\n\nconst emit = defineEmits(['refresh', 'edit', 'delete', 'change', 'register'])\n\n// 内部分页配置\nconst innerPagination = computed(() => {\n  if (props.pagination === false) {\n    return false\n  }\n  return {\n    current: 1,\n    pageSize: 10,\n    total: 0,\n    showSizeChanger: true,\n    showQuickJumper: true,\n    showTotal: (total) => `共 ${total} 条`,\n    ...props.pagination\n  }\n})\n\n// 内部列配置（添加操作列）\nconst innerColumns = computed(() => {\n  const cols = [...props.columns]\n  if (props.actionColumn) {\n    cols.push({\n      title: '操作',\n      key: 'action',\n      fixed: 'right',\n      width: 150,\n      ...props.actionColumn,\n      slots: { customRender: 'action' }\n    })\n  }\n  return cols\n})\n\n// 刷新\nconst handleRefresh = () => {\n  emit('refresh')\n  if (props.api) {\n    reload()\n  }\n}\n\n// 编辑\nconst handleEdit = (record) => {\n  emit('edit', record)\n}\n\n// 删除\nconst handleDelete = (record) => {\n  emit('delete', record)\n}\n\n// 表格变化（分页、排序、筛选）\nconst handleTableChange = (pagination, filters, sorter) => {\n  emit('change', { pagination, filters, sorter })\n}\n\n// 加载数据\nconst loading = ref(false)\nconst reload = async (params = {}) => {\n  if (!props.api) return\n\n  try {\n    loading.value = true\n    const mergedParams = { ...props.searchParams, ...params }\n\n    // 如果有分页配置，添加分页参数\n    if (innerPagination.value) {\n      mergedParams.page = innerPagination.value.current\n      mergedParams.pageSize = innerPagination.value.pageSize\n    }\n\n    const result = await props.api(mergedParams)\n\n    // 假设返回格式为 { data: [], total: 0 }\n    if (result.data) {\n      emit('update:dataSource', result.data)\n      if (innerPagination.value) {\n        innerPagination.value.total = result.total || 0\n      }\n    }\n  } catch (error) {\n    console.error('Failed to load table data:', error)\n  } finally {\n    loading.value = false\n  }\n}\n\n// 立即加载\nif (props.immediate && props.api) {\n  reload()\n}\n\n// 监听搜索参数变化\nwatch(() => props.searchParams, () => {\n  if (props.api) {\n    reload()\n  }\n}, { deep: true })\n\n// 暴露方法给父组件\ndefineExpose({\n  reload\n})\n\n// 注册表格实例\nemit('register', { reload })\n</script>\n\n<style scoped>\n.basic-table {\n  background: #fff;\n  border-radius: 2px;\n}\n\n.table-toolbar {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.toolbar-left {\n  flex: 1;\n}\n\n.toolbar-right {\n  flex-shrink: 0;\n}\n\n.table-title {\n  font-size: 16px;\n  font-weight: 500;\n}\n</style>\n"],"names":[],"mappings":"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"}