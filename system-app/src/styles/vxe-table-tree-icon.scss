/**
 * VXE Table 树形图标自定义样式
 *
 * 问题：VXE Table 默认的树形展开图标显示为空心方框
 * 解决：使用 ::before 伪元素覆盖默认图标，插入实心三角形
 *
 * 使用方法：
 * 在 main.js 中引入: import './styles/vxe-table-tree-icon.scss'
 */

/* ==================== 树形展开按钮 ==================== */

/* 支持多种可能的类名（兼容不同 VXE Table 版本） */
.vxe-cell--tree-btn,
.vxe-tree--btn-wrapper,
.vxe-tree-btn,
[class*="vxe"][class*="tree"][class*="btn"] {
  position: relative !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 20px !important;
  height: 20px !important;
  min-width: 20px !important;  /* 防止收缩 */
  margin-right: 8px !important;
  cursor: pointer !important;
  border-radius: 4px !important;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
  vertical-align: middle !important;
  background: transparent !important;
  border: none !important;
  padding: 0 !important;

  /* 隐藏原始图标元素 */
  > * {
    display: none !important;
  }

  i,
  svg,
  span {
    display: none !important;
  }

  /* 使用 ::before 伪元素插入自定义图标 */
  &::before {
    content: '▶' !important;
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
    font-size: 11px !important;
    font-weight: bold !important;
    font-style: normal !important;
    color: rgba(0, 0, 0, 0.65) !important;
    line-height: 1 !important;
    display: block !important;
    z-index: 1 !important;
  }

  /* 悬停效果 */
  &:hover {
    background-color: rgba(24, 144, 255, 0.1) !important;

    &::before {
      color: #1890ff !important;
      transform: translate(-50%, -50%) scale(1.15) !important;
    }
  }

  /* 展开状态（支持多种可能的 class 名） */
  &.is--active::before,
  &.active::before,
  &.is-active::before,
  &.expanded::before,
  &.open::before {
    content: '▼' !important;
    color: #1890ff !important;
  }

  /* 禁用状态 */
  &:disabled,
  &.is--disabled {
    opacity: 0.4 !important;
    cursor: not-allowed !important;

    &:hover {
      background-color: transparent !important;

      &::before {
        color: rgba(0, 0, 0, 0.65) !important;
        transform: translate(-50%, -50%) !important;
      }
    }
  }
}

/* ==================== 树形单元格 ==================== */

.vxe-tree-cell {
  display: flex !important;
  align-items: center !important;
  gap: 4px !important;
}

/* ==================== 树形节点缩进 ==================== */

/* 根据数据层级添加缩进 */
.vxe-body--row {
  &[data-level="1"],
  &.row--level-1,
  &.tree-level-1 {
    .vxe-tree-cell {
      padding-left: 16px !important;
    }
  }

  &[data-level="2"],
  &.row--level-2,
  &.tree-level-2 {
    .vxe-tree-cell {
      padding-left: 40px !important;
    }
  }

  &[data-level="3"],
  &.row--level-3,
  &.tree-level-3 {
    .vxe-tree-cell {
      padding-left: 64px !important;
    }
  }

  &[data-level="4"],
  &.row--level-4,
  &.tree-level-4 {
    .vxe-tree-cell {
      padding-left: 88px !important;
    }
  }
}

/* ==================== 可选：树形连接线 ==================== */

/* 如果需要显示树形连接线，取消下面的注释 */
/*
.vxe-tree--indent {
  position: relative;

  &::before {
    content: '';
    position: absolute;
    left: 10px;
    top: 0;
    bottom: 0;
    width: 1px;
    background-color: #f0f0f0;
  }
}
*/

/* ==================== 加载状态动画 ==================== */

.vxe-cell--tree-btn.is--loading,
.vxe-tree--btn-wrapper.is--loading {
  &::before {
    content: '⏳' !important;
    animation: tree-btn-loading 1s linear infinite !important;
  }
}

@keyframes tree-btn-loading {
  0% {
    transform: translate(-50%, -50%) rotate(0deg);
  }
  100% {
    transform: translate(-50%, -50%) rotate(360deg);
  }
}

/* ==================== 自定义主题色 ==================== */

/* 如果项目使用不同的主题色，可以通过 CSS 变量自定义 */
:root {
  --vxe-tree-icon-color: rgba(0, 0, 0, 0.65);
  --vxe-tree-icon-hover-color: #1890ff;
  --vxe-tree-icon-hover-bg: rgba(24, 144, 255, 0.1);
  --vxe-tree-icon-active-color: #1890ff;
}

/* 使用 CSS 变量（可选） */
.vxe-cell--tree-btn,
.vxe-tree--btn-wrapper {
  &::before {
    color: var(--vxe-tree-icon-color) !important;
  }

  &:hover {
    background-color: var(--vxe-tree-icon-hover-bg) !important;

    &::before {
      color: var(--vxe-tree-icon-hover-color) !important;
    }
  }

  &.is--active::before,
  &.active::before {
    color: var(--vxe-tree-icon-active-color) !important;
  }
}

/* ==================== 暗色主题支持 ==================== */

/* 如果使用暗色主题，取消下面的注释 */
/*
[data-theme="dark"] {
  .vxe-cell--tree-btn,
  .vxe-tree--btn-wrapper {
    &::before {
      color: rgba(255, 255, 255, 0.65) !important;
    }

    &:hover {
      background-color: rgba(64, 169, 255, 0.15) !important;

      &::before {
        color: #40a9ff !important;
      }
    }

    &.is--active::before,
    &.active::before {
      color: #40a9ff !important;
    }
  }
}
*/

/* ==================== 调试模式 ==================== */

/* 开发环境下可以启用此样式查看图标边界 */
/*
[data-debug="true"] {
  .vxe-cell--tree-btn,
  .vxe-tree--btn-wrapper {
    border: 1px dashed #ff0000 !important;

    &::before {
      background-color: rgba(255, 0, 0, 0.1) !important;
    }
  }
}
*/
